###############################################
# WhiteHills URL Rewrites (IONOS / Apache)
###############################################
RewriteEngine On
Options -MultiViews
RewriteBase /
DirectoryIndex index.html

# ====== TIPOS MIME (evita 'Unexpected token <' en .js/.json/.webmanifest) ======
AddType application/javascript        .js
AddType application/json              .json
AddType application/manifest+json     .webmanifest
AddType text/css                      .css
AddType image/svg+xml                 .svg

# ====== CACHÉ ESTÁTICOS (opcional pero recomendable) ======
<IfModule mod_expires.c>
  ExpiresActive On
  ExpiresByType text/css                       "access plus 1 month"
  ExpiresByType application/javascript         "access plus 1 month"
  ExpiresByType application/json               "access plus 1 week"
  ExpiresByType application/manifest+json      "access plus 1 week"
  ExpiresByType image/svg+xml                  "access plus 1 month"
  ExpiresByType image/webp                     "access plus 1 year"
  ExpiresByType image/png                      "access plus 1 year"
  ExpiresByType image/jpeg                     "access plus 1 year"
  ExpiresByType image/gif                      "access plus 1 year"
</IfModule>

# ====== BYPASS: si existe archivo o carpeta → NO reescribir ======
RewriteCond %{REQUEST_FILENAME} -f [OR]
RewriteCond %{REQUEST_FILENAME} -d
RewriteRule ^ - [L]

# ====== CANÓNICA: /index.html → /es/inicio (cámbialo a 301 cuando valides) ======
RewriteCond %{THE_REQUEST} \s/+(index\.html)[\s?] [NC]
RewriteRule ^index\.html$ en/home [R=302,L]

# ====== Home raíz → ES (302 mientras pruebas; luego 301) ======
RewriteRule ^$ en/home [R=302,L]

# ====== Raíces de idioma ======
RewriteRule ^es/?$ es/inicio [R=301,L]
RewriteRule ^en/?$ en/home   [R=301,L]

# ====== HOME ======
RewriteRule ^es/inicio/?$ index.html [L,NC]
RewriteRule ^en/home/?$    index.html [L,NC]

# ====== SECCIONES dentro de index.html ======
RewriteRule ^es/disponibilidad/?$ index.html?section=availability [QSA,L,NC]
RewriteRule ^en/availability/?$   index.html?section=availability [QSA,L,NC]
RewriteRule ^es/localizacion/?$   index.html?section=location     [QSA,L,NC]
RewriteRule ^en/location/?$       index.html?section=location     [QSA,L,NC]

# ====== PÁGINAS FÍSICAS ======
# ES
RewriteRule ^es/proceso-compra/?$       proceso.html         [L,NC]
RewriteRule ^es/contacto/?$             contact.html         [L,NC]
RewriteRule ^es/aviso-legal/?$          legal-notice.html    [L,NC]
RewriteRule ^es/politica-cookies/?$     cookies-policy.html  [L,NC]
RewriteRule ^es/politica-privacidad/?$  privacy-policy.html  [L,NC]

# EN (mapean a los mismos .html físicos)
RewriteRule ^en/process/?$        proceso.html         [L,NC]
RewriteRule ^en/contact/?$        contact.html         [L,NC]
RewriteRule ^en/legal-notice/?$   legal-notice.html    [L,NC]
RewriteRule ^en/cookie-policy/?$  cookies-policy.html  [L,NC]
RewriteRule ^en/privacy-policy/?$ privacy-policy.html  [L,NC]

# ====== GALERÍA (ES/EN) ======
# Canoniza /galeria.html → /es/galeria (mientras pruebas, 302)
RewriteCond %{THE_REQUEST} \s/+(galeria\.html)[\s?] [NC]
RewriteRule ^galeria\.html$ es/galeria [R=302,L]

# Mapeo a archivo físico
RewriteRule ^es/galeria/?$ galeria.html [L,NC]
RewriteRule ^en/gallery/?$ galeria.html [L,NC]


# ====== CATCH-ALL de idioma → index.html (evita 404 con /es/... o /en/...) ======
RewriteRule ^(es|en)/.+$ index.html [QSA,L,NC]

# ====== (Opcional) Forzar HTTPS ======
#RewriteCond %{HTTPS} !=on
#RewriteRule ^ https://%{HTTP_HOST}%{REQUEST_URI} [L,R=301]
